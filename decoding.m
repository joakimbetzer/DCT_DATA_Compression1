close all; clear all; clc;
N=512; % signal length
L=8; % transform length
M=4; % select the number of DCT coefficients 

%% Load the test signal

load mit200
x=ecgsig(1:N,1);

%% dct transform of signal
H=dctmtx(L);

data = [[0.990080,-0.000000,0.000000,0.000000,-0.491504,0.449845,0.138956,0.432322,-0.599352,0.035191,0.001817,-0.035762,-0.655928,-0.031584,-0.019974,-0.005576,-0.525096,-0.009694,-0.012269,0.052093,-0.546312,-0.003420,0.012488,0.023259,-0.424320,-0.067178,0.018982,-0.001353,-0.470288,-0.041866,0.010583,0.040778,-0.316472,-0.030411,0.012677,0.027317,-0.189176,-0.023638,0.001204,0.000397,-0.028288,-0.058264,-0.021886,0.014417,0.076024,-0.019790,0.012619,0.002309,0.081328,-0.000162,-0.005594,-0.031540,-0.206856,-0.004513,0.134875,0.233260,-0.173264,0.040209,0.002018,0.007885,-0.233376,0.026244,-0.005320,-0.009798,-0.295256,0.035191,0.001817,-0.009634,-0.447304,0.031357,0.013978,-0.011548,-0.486200,0.006609,0.001104,-0.010755,-0.588744,0.011674,0.010854,-0.000397,-0.606424,-0.040820,0.009707,0.014020,-0.510952,-0.030418,0.000888,-0.005576,-0.546312,0.025814,-0.000764,0.025964,-0.533936,-0.009941,0.018693,-0.004619,-0.698360,0.029003,0.012827,-0.010755,-0.790296,-0.127543,-0.023228,0.148065,0.155584,-0.195656,0.058325,-0.140577,-2.620176,1.214117,0.134109,0.205570,-3.757000,-0.429530,-0.064712,0.106728,-2.514096,-0.131467,-0.014759,0.025568,-1.716728,-0.265645,-0.027827,-0.009402,-0.784992,-0.319668,-0.025211,0.028274,0.242216,-0.073024,-0.141390,-0.220196,0.380120,-0.075215,-0.005889,-0.005575,0.670072,-0.088235,-0.020147,0.002309,0.869856,-0.022534,0.003495,-0.012504,1.018368,-0.042392,-0.014247,-0.030187,1.136824,-0.008103,-0.011368,-0.002310,1.090856,0.027443,0.016067,-0.014254,0.871624,0.117024,-0.007862,-0.014020,0.562224,0.111764,-0.009177,0.006532,0.226304,0.154553,-0.000012,-0.025008,-0.148512,0.071828,-0.005942,-0.014977,-0.300560,0.047275,-0.002408,0.020389,-0.450840,0.003287,0.014519,-0.007489,-0.489736,-0.034135,-0.009075,0.022698,-0.452608,0.008248,0.011554,0.033453,-0.449072,0.017682,0.017302,-0.032893,-0.496808,-0.032998,-0.006259,-0.019993,-0.500344,0.016079,-0.010793,0.004222,-0.562224,0.030739,0.013915,0.009798,-0.463216,-0.071145,-0.003882,-0.023655,-0.321776,-0.036741,-0.004958,-0.003266,-0.461448,0.043657,0.022131,0.044207,-0.475592,-0.008735,-0.010164,-0.002309,-0.434928,-0.004530,-0.001591,0.009798,-0.532168,0.020881,0.024512,0.025965,-0.503880,-0.033438,0.004679,-0.014021,-0.473824,0.021875,-0.001318,-0.002706,-0.143208,-0.431327,-0.003317,0.083865,1.912976,-0.688680,-0.053907,0.025008,1.760928,1.585541,-0.203253,-0.466805,-1.258816,-0.168262,0.064843,0.074231,-0.899912,0.014570,-0.016175,-0.039029]]

y = reshape(data, [4, 64])

y_transmit=y(1:M,:);


%% To reconstruct the orignal signal
y_receive=zeros(L,N/L);
y_receive(1:M,:)=y_transmit;
x_rec=[];
invH=H^(-1);
for i=1:N/L
x_rec=[x_rec;invH*y_receive(:,i)];
end


plot(x);
hold on;
plot((x_rec), 'r.');
legend('Original', 'Recovered','Location','best');